# 検索技術
# 学期末課題レポート

21X3007
畔上達希
 
## 1. 目的
 クラスタリングを行うことで、データの分析手法を学ぶ。

## 2. 方法
### 2.1. データセット
 breast cancerデータセットを、k-means法を用いて分類する。
 breast cancerデータセットは、乳がんの有無を判別する単純な二値分類データセットであり、mean radius、mean texture、mean perimeter、mean area、mean smoothness、mean compactness、mean concavity、mean concave points、mean symmetry、mean fractal dimension、radius error、texture error、perimeter error、area error、smoothness error、compactness error、concavity error、concave points error、symmetry error、fractal dimension error、worst radius、worst texture、worst perimeter、worst area、worst smoothness、worst compactness、worst concavity、worst concave points、worst symmetry、worst fractal dimensionの乳房腫瘤の細針吸引 (FNA) のデジタル化された画像から計算された30パラメータをもった569個のデータを持つデータセットである。
 このデータセットを用いて、乳がん検査においての悪性、良性の判別を行う。

### 2.2. 手法
 k-means法は、与えられた値の集合をランダムにk個のクラスタに分け、各クラスタの重心を計算、重心からの距離をそれぞれの要素で計算し、その要素に最も重心が近いクラスタに分類しなす。このようにして更新されたクラスタに関して重心を計算し、距離を計算、クラスタを更新することを繰り返すことでクラスタリングを行う。
 今回用いたbreast cancerデータセットは単純な二値分類を扱い、データのパラメータも多いことから、重心との距離が近いクラスタに分類するだけの単純なクラスタリング方法でも十分な識別が行えると考え、k-means法を選択した。

### 2.3. k-means法の実装
 breast cancerデータセットに対して、k-means法による分類を行う。
 sklearn.datasetsからload_breast_cancerをインポートし、データセットを読み込んだ。
 読み込んだデータセットでpandasのデータフレームを作成した。データのtargetを、0ならmalignant(悪性)、1ならbenign(良性)とした。
 seaborn、matplotlibを用いて、データをmean radiusとmean textureの値を用いてグラフにプロットし、targetによって色を変更することでそれぞれの分布を確認した。
 sklearn.clusterからインポートしたKMeansを用いて、mean radius、mean textureの二つを用いたk-means法によるクラスタリングを行った。このとき、悪性と良性を判別することから、クラスタ数は2とした。
 データをmean radiusとmean textureの値を用いてグラフにプロットし、分類結果によって色を変更することでそれぞれの分布を確認した。
 分類結果をデータのtargetと比較し、一致率を調べた。
 k-means法に用いるパラメータ数を1から30まで変化させたとき、パラメータ数を3として使用するパラメータを変更したときそれぞれの一致率を調べ、変化を観察した。パラメータを3に固定した時、パラメータは連番の3つを使用した。
 
### 2.4. 主成分分析を行ったk-means法
 k-means法の入力データに対し、主成分分析を行う。
 データに対して標準化を行い、sklearn.decompositionからインポートしたPCAを用いて主成分分析を行った。
 抽出された成分を用いて、2.3と同様にk-means法によるクラスタリングを行った。
 
## 3. 結果
 データをmean radiusとmean textureの値を用いてグラフにプロットし、targetによって色を変更した結果を図１に示す。

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/ad083eeb-2381-4980-b20c-c2d3b12dca3f)
図１ mean radiusとmean texture上での良性と悪性の分布

 図１から、malignantとbenignの分布は明確に分かれているが、境界部分は重なり合っていた。
 データをmean radiusとmean textureの値を用いてグラフにプロットし、分類結果によって色を変更した結果を図２に示す。

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/88437251-d5c8-4f51-8085-e281072cb206)
図２ mean radiusとmean texture上での分類結果の分布

 図2から、分類結果は重なり合わずに分布していた。

 分類結果とデータのtargetの一致率は、約83.3%となった。
 このとき、判別率が約16.7%となることがあったが、これはk-means法はまずランダムなクラスタに分類するところから始めるため、ターゲットの0と1がランダムに変化してしまうことが原因であると考えられる。このことから、一致率は50%より小さい場合は反転して考えることとした。

 k-means法に用いるパラメータ数を1から30まで変化させたときの一致率の変化を図3に示す。

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/5cc36a29-a7c2-4723-b6a2-a1da312ea0a9)
図3 パラメータ数の変化による一致率の推移
 
 図3から、パラメータ数が3のときに一致率は最大となり、特定のパラメータが増えたときのみ一致率が変化するが、それ以外のパラメータを追加したとき、一致率は変化しなかった。

パラメータ数を3として使用するパラメータを変更したときの一致率の変化を図4に示す

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/9ae1445e-dcfb-4183-bf49-3e2858f155a9)
図4 パラメータ数を3とし、使用パラメータを変更したときの一致率

 図4から、パラメータによって一致率が大きくなる場合と小さくなる場合がはっきりと分かれた。
 主成分分析によって抽出された成分の第1成分と第2成分をグラフにプロットし、targetによって色を変更した結果を図5に示す。

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/10bc7d7e-c3ac-42d6-8f4a-8cf258730a0c)
図5 主成分分析によって抽出された成分の第1成分と第2成分上でのtargetの分布

 図5から、グラフが大きく広がり、targetの分布の重なりが小さくなっていた。

 主成分分析によって得られた成分を用いて、2.3と同様にk-means法によるクラスタリングを行い、主成分分析によって抽出された成分の第1成分と第2成分をグラフにプロットし、分類結果によって色を変更した結果を図6に示す。

 ![image](https://github.com/Azemichi1019/k-means_report/assets/59964400/5e17afa9-c28a-4640-bc26-d085988a8392)
図6 主成分分析によって抽出された成分の第1成分と第2成分上での分類結果の分布

 図6から、分類結果は重なり合わずに分布していた。

分類結果とデータのtargetの一致率は、約90.9%となった。
 
## 4. 考察
 データをmean radiusとmean textureの値を用いてグラフにプロットし、targetによって色を変更した結果、それぞれの分布の境界部分は重なり合っていたが、データをmean radiusとmean textureの値を用いてグラフにプロットし、分類結果によって色を変更した結果、分類結果は重なり合わずに分布していた。また、分類結果とデータのtargetの一致率は、約83.3%となった。
 これは、k-means法は求められた重心からの距離で分類が行われ、これは分類の為に線形的な境界を設けることと等しいため、重なり合った部分を正確に分類できなかったと考えられる。

 k-means法に用いるパラメータ数を1から30まで変化させたとき、パラメータ数が3のときに一致率は最大となり、特定のパラメータが増えたときのみ一致率が変化するが、それ以外のパラメータを追加したとき、一致率は変化しなかった。
 これは、パラメータによって影響の強弱があり、影響が小さいパラメータを追加しても分類結果がほとんど変化しなかったと考えられる。このことから、パラメータ数が3の時に使用したパレメータや、パラメータ数を24にしたときに追加したパラメータを用いて分類を行うことで、精度を向上できると考えられる。

パラメータ数を3として使用するパラメータを変更した結果、パラメータによって一致率が大きくなる場合と小さくなる場合がはっきりと分かれた。
 これは、分類に影響を与えないデータが含まれているためであると考えられ、図4において低い一致率を持たないパラメータを分類に用いることが適切であると考えられる。

 主成分分析によって抽出された成分の第1成分と第2成分をグラフにプロットし、targetによって色を変更した結果、グラフが大きく広がり、targetの分布の重なりが小さくなっていた。
 これは、主成分分析によって少ない変数に情報が集約され、targetによる違いが出やすくなったためであると考えられる。

 主成分分析によって得られた成分を用いて、2.3と同様にk-means法によるクラスタリングを行い、主成分分析によって抽出された成分の第1成分と第2成分をグラフにプロットし、分類結果によって色を変更した結果、分類結果は重なり合わずに分布しており、分類結果とデータのtargetの一致率は、約90.9%となった。
 このとき、2つのパラメータを用いたk-means法を行ったが、主成分分析を行わない場合の最大の一致率よりも一致率が大きくなった。これは主成分分析によって情報が集約されたため、2つのパラメータでも十分な分類が行えたと考えられる。しかし、癌を判別するという人命にかかわることを判断する問題において、90.9%の精度は低いといえる。これは、k-means法が線形的な分類しか行えないことに原因があると考えられ、他の分類方法を模索する必要があると考えられる。

